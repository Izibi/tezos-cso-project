(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"99Un":function(e,t,n){"use strict";n.r(t),n.d(t,"HomePageModule",function(){return k});var o=n("ofXK"),i=n("3Pt+"),a=n("TEn/"),l=n("iTUp"),c=n("j1ZV"),r=n("tyNb"),s=n("9YfS"),b=n("DYCq"),p=n("Xcrz"),_=n("6nr9"),g=n("ASmo"),P=n("EFtB"),d=n("pXfl"),m=n("itXk"),u=n("lJxs"),h=n("fXoL"),T=n("Y22S");function WalletSelectPage_ion_list_8_ng_container_9_ion_text_7_Template(e,t){if(1&e&&(h.Pb(0,"ion-text"),h.Pb(1,"small"),h.Pb(2,"span"),h.Pb(3,"strong"),h.oc(4,"Derivation Path:"),h.Ob(),h.Ob(),h.Ob(),h.Pb(5,"p",10),h.oc(6),h.Ob(),h.Ob()),2&e){const e=h.Zb(2).ngIf;h.Ab(6),h.pc(e.derivationPath)}}function WalletSelectPage_ion_list_8_ng_container_9_Template(e,t){if(1&e&&(h.Nb(0),h.Pb(1,"div",7),h.Lb(2,"identicon",8),h.Pb(3,"p",9),h.oc(4),h.Ob(),h.Ob(),h.Pb(5,"p",10),h.oc(6),h.Ob(),h.nc(7,WalletSelectPage_ion_list_8_ng_container_9_ion_text_7_Template,7,1,"ion-text",4),h.Mb()),2&e){const e=h.Zb().ngIf,t=h.Zb();h.Ab(2),h.fc("address",e.address),h.Ab(2),h.pc(e.address),h.Ab(2),h.pc(e.publicKey),h.Ab(1),h.fc("ngIf",e.type===t.walletTypes.LEDGER)}}function WalletSelectPage_ion_list_8_ng_container_10_Template(e,t){if(1&e&&(h.Nb(0),h.Pb(1,"div",7),h.Pb(2,"p",9),h.oc(3,"Beacon connected wallet"),h.Ob(),h.Ob(),h.Pb(4,"p",10),h.oc(5),h.Ob(),h.Mb()),2&e){const e=h.Zb().ngIf;h.Ab(5),h.pc(e.info.publicKey)}}function WalletSelectPage_ion_list_8_Template(e,t){if(1&e&&(h.Pb(0,"ion-list"),h.Pb(1,"ion-list-header"),h.Pb(2,"ion-label"),h.oc(3,"Active Wallet"),h.Ob(),h.Ob(),h.Pb(4,"ion-item",6),h.Pb(5,"ion-label"),h.Pb(6,"h3"),h.Pb(7,"strong"),h.oc(8),h.Ob(),h.Ob(),h.nc(9,WalletSelectPage_ion_list_8_ng_container_9_Template,8,4,"ng-container",4),h.nc(10,WalletSelectPage_ion_list_8_ng_container_10_Template,6,1,"ng-container",4),h.Ob(),h.Ob(),h.Ob()),2&e){const e=t.ngIf,n=h.Zb();h.Ab(8),h.pc(e.type),h.Ab(1),h.fc("ngIf",e.type!==n.walletTypes.P2P),h.Ab(1),h.fc("ngIf",e.type===n.walletTypes.P2P)}}function WalletSelectPage_ion_item_14_ng_container_5_Template(e,t){if(1&e&&(h.Nb(0),h.Pb(1,"div",7),h.Lb(2,"identicon",8),h.Pb(3,"p",9),h.oc(4),h.Ob(),h.Ob(),h.Pb(5,"p",10),h.oc(6),h.Ob(),h.Mb()),2&e){const e=h.Zb().$implicit;h.Ab(2),h.fc("address",e.address),h.Ab(2),h.pc(e.address),h.Ab(2),h.pc(e.publicKey)}}function WalletSelectPage_ion_item_14_ng_container_6_Template(e,t){if(1&e&&(h.Nb(0),h.Pb(1,"div",7),h.Pb(2,"p",9),h.oc(3,"Beacon connected wallet"),h.Ob(),h.Ob(),h.Pb(4,"p",10),h.oc(5),h.Ob(),h.Mb()),2&e){const e=h.Zb().$implicit;h.Ab(5),h.pc(e.info.publicKey)}}function WalletSelectPage_ion_item_14_Template(e,t){if(1&e){const e=h.Qb();h.Pb(0,"ion-item",6),h.Pb(1,"ion-label"),h.Pb(2,"h3"),h.Pb(3,"strong"),h.oc(4),h.Ob(),h.Ob(),h.nc(5,WalletSelectPage_ion_item_14_ng_container_5_Template,7,3,"ng-container",4),h.nc(6,WalletSelectPage_ion_item_14_ng_container_6_Template,6,1,"ng-container",4),h.Ob(),h.Pb(7,"div",1),h.Pb(8,"ion-button",11),h.Xb("click",function WalletSelectPage_ion_item_14_Template_ion_button_click_8_listener(){h.kc(e);const n=t.$implicit;return h.Zb().activateWallet(n)}),h.oc(9," Activate "),h.Ob(),h.Pb(10,"ion-button",12),h.Xb("click",function WalletSelectPage_ion_item_14_Template_ion_button_click_10_listener(){h.kc(e);const n=t.$implicit;return h.Zb().deleteWallet(n)}),h.Lb(11,"ion-icon",13),h.Ob(),h.Ob(),h.Ob()}if(2&e){const e=t.$implicit,n=h.Zb();h.Ab(4),h.pc(e.type),h.Ab(1),h.fc("ngIf",e.type!==n.walletTypes.P2P),h.Ab(1),h.fc("ngIf",e.type===n.walletTypes.P2P)}}let O=(()=>{class WalletSelectPage{constructor(e,t,n){this.modalController=e,this.walletService=t,this.alertController=n,this.walletTypes=g.b,this.activeWallet$=this.walletService.activeWallet$,this.wallets$=Object(m.a)([this.walletService.wallets$,this.walletService.activeWallet$]).pipe(Object(u.a)(([e,t])=>e.filter(e=>e.publicKey!==t.publicKey)))}async activateWallet(e){await this.walletService.setActiveWallet(e),await this.dismiss()}async deleteWallet(e){const t=await this.alertController.create({header:"Delete Wallet?",message:"Are you sure you want to delete this wallet? You will have to pair it again if you want to use it again.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary"},{text:"Yes",handler:async()=>{await this.walletService.deleteWallet(e)}}]});await t.present()}async dismiss(e=!1){await this.modalController.dismiss(e)}}return WalletSelectPage.\u0275fac=function WalletSelectPage_Factory(e){return new(e||WalletSelectPage)(h.Kb(a.N),h.Kb(p.a),h.Kb(a.a))},WalletSelectPage.\u0275cmp=h.Eb({type:WalletSelectPage,selectors:[["app-wallet-select"]],decls:16,vars:6,consts:[[1,"ion-no-border"],["slot","end"],[3,"click"],["name","close"],[4,"ngIf"],["lines","none",4,"ngFor","ngForOf"],["lines","none"],[1,"d-flex","ion-align-items-center"],[3,"address"],[1,"ion-no-margin"],[1,"ion-text-wrap"],["size","small","fill","outline","color","primary",3,"click"],["size","small","fill","outline","color","dark",3,"click"],["slot","icon-only","name","trash-outline"]],template:function WalletSelectPage_Template(e,t){1&e&&(h.Pb(0,"ion-header",0),h.Pb(1,"ion-toolbar"),h.Pb(2,"ion-title"),h.oc(3,"Paired Wallets"),h.Ob(),h.Pb(4,"ion-buttons",1),h.Pb(5,"ion-button",2),h.Xb("click",function WalletSelectPage_Template_ion_button_click_5_listener(){return t.dismiss()}),h.Lb(6,"ion-icon",3),h.Ob(),h.Ob(),h.Ob(),h.Ob(),h.Pb(7,"ion-content"),h.nc(8,WalletSelectPage_ion_list_8_Template,11,3,"ion-list",4),h.ac(9,"async"),h.Pb(10,"ion-list"),h.Pb(11,"ion-list-header"),h.Pb(12,"ion-label"),h.oc(13,"Other Wallets"),h.Ob(),h.Ob(),h.nc(14,WalletSelectPage_ion_item_14_Template,12,3,"ion-item",5),h.ac(15,"async"),h.Ob(),h.Ob()),2&e&&(h.Ab(8),h.fc("ngIf",h.bc(9,2,t.activeWallet$)),h.Ab(6),h.fc("ngForOf",h.bc(15,4,t.wallets$)))},directives:[a.p,a.J,a.H,a.i,a.h,a.q,a.n,o.l,a.u,a.v,a.t,o.k,a.s,T.a,a.F],pipes:[o.b],styles:["div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 8px}"]}),WalletSelectPage})();var f=n("wkvF"),w=n("7gy2");function HomePage_img_12_Template(e,t){1&e&&h.Lb(0,"img",14)}function HomePage_img_13_Template(e,t){1&e&&h.Lb(0,"img",15)}function HomePage_img_14_Template(e,t){1&e&&h.Lb(0,"img",16)}function HomePage_ng_container_22_ng_container_1_Template(e,t){1&e&&(h.Nb(0),h.Pb(1,"p",17),h.Pb(2,"strong"),h.oc(3,"All requests will be redirected to your paired wallet."),h.Ob(),h.Ob(),h.Mb())}function HomePage_ng_container_22_ng_container_2_ion_row_19_Template(e,t){if(1&e&&(h.Pb(0,"ion-row"),h.Pb(1,"ion-col"),h.Pb(2,"p",10),h.Pb(3,"small"),h.oc(4,"Network"),h.Ob(),h.Ob(),h.Pb(5,"h3",10),h.oc(6),h.Ob(),h.Ob(),h.Ob()),2&e){const e=h.Zb(3);h.Ab(6),h.pc(e.network.type)}}const _c0=function(e){return{protocolIdentifier:e,maxDigits:10}};function HomePage_ng_container_22_ng_container_2_Template(e,t){if(1&e){const e=h.Qb();h.Nb(0),h.Pb(1,"ion-row"),h.Pb(2,"ion-col"),h.Pb(3,"p",10),h.Pb(4,"small"),h.oc(5,"Address"),h.Ob(),h.Ob(),h.Pb(6,"div",18),h.Xb("click",function HomePage_ng_container_22_ng_container_2_Template_div_click_6_listener(){return h.kc(e),h.Zb(2).openBlockexplorer()}),h.Lb(7,"identicon",19),h.Pb(8,"h6"),h.oc(9),h.Lb(10,"ion-icon",20),h.Ob(),h.Ob(),h.Ob(),h.Ob(),h.Pb(11,"ion-row",21),h.Pb(12,"ion-col"),h.Pb(13,"p",10),h.Pb(14,"small"),h.oc(15,"Amount"),h.Ob(),h.Ob(),h.Pb(16,"h3",10),h.oc(17),h.ac(18,"amountConverter"),h.Ob(),h.Ob(),h.Ob(),h.nc(19,HomePage_ng_container_22_ng_container_2_ion_row_19_Template,7,1,"ion-row",11),h.Mb()}if(2&e){const e=h.Zb(2);h.Ab(7),h.fc("address",e.address),h.Ab(2),h.qc(" ",e.address," "),h.Ab(8),h.qc(" ",h.cc(18,4,e.balance,h.ic(7,_c0,e.protocolIndentifiers.XTZ))," "),h.Ab(2),h.fc("ngIf",e.network)}}function HomePage_ng_container_22_Template(e,t){if(1&e&&(h.Nb(0),h.nc(1,HomePage_ng_container_22_ng_container_1_Template,4,0,"ng-container",11),h.nc(2,HomePage_ng_container_22_ng_container_2_Template,20,9,"ng-container",11),h.Mb()),2&e){const e=h.Zb();h.Ab(1),h.fc("ngIf",e.walletType===e.walletTypes.P2P),h.Ab(1),h.fc("ngIf",e.walletType===e.walletTypes.LOCAL_MNEMONIC||e.walletType===e.walletTypes.LEDGER)}}var E=function(e){return e.WALLET="WALLET",e.LEDGER="LEDGER",e.LOCAL_MNEMONIC="LOCAL_MNEMONIC",e}({});const y=[{path:"",component:(()=>{class HomePage{constructor(e,t,n,o,i){this.walletService=e,this.modalController=t,this.settingsService=n,this.chromeMessagingService=o,this.ref=i,this.protocolIndentifiers=s.MainProtocolSymbols,this.signingMethods=E,this.walletTypes=g.b,this.currentSigningMethod="Unpaired",this.balance="",this.tezblockLink="",this.address="",this.walletService.activeNetwork$.subscribe(async e=>{this.network=e,await this.updateBalanceAndLink()}),this.checkOnboarding().catch(console.error),this.walletService.activeWallet$.subscribe(async e=>{this.address=e.address,this.walletType=e.type,this.currentSigningMethod=e.type===g.b.LOCAL_MNEMONIC?"Local Mnemonic":e.type===g.b.LEDGER?"Ledger":"Beacon P2P",e.type!==g.b.P2P&&await this.updateBalanceAndLink()}),location.href.includes("pair-ledger")&&this.openLedger()}async updateBalanceAndLink(){if(!this.network)return;const[e,t]=await Promise.all([this.getBalance(this.address,this.network),this.getBlockexplorer(this.address,this.network)]);this.balance=e,this.tezblockLink=t,this.ref.detectChanges()}async showPairPage(){return(await this.modalController.create({component:d.a})).present()}async checkOnboarding(){await this.chromeMessagingService.sendChromeMessage(g.a.WALLETS_GET,void 0).then(e=>!!e.data&&e.data.wallets.length>0)||location.href.includes("pair-ledger")||await this.showPairPage()}async openWalletSelection(){const e=await this.modalController.create({component:O});return e.onDidDismiss().then(()=>{}),e.present()}async getBalance(e,t){if(console.log("getBalance",e),!e)return"";const n=await this.settingsService.getProtocolForNetwork(t),o=await n.getBalanceOfAddresses([e]);return console.log("getBalance",o),o}async getBlockexplorer(e,t){return`${await Object(P.c)(t)}${e}`}async openBlockexplorer(){window.open(this.tezblockLink)}async openLedger(){const e=await this.modalController.create({component:f.a,componentProps:{targetMethod:g.a.LEDGER_INIT}});return e.onWillDismiss().then(()=>{}).catch(e=>console.error(e)),e.present()}}return HomePage.\u0275fac=function HomePage_Factory(e){return new(e||HomePage)(h.Kb(p.a),h.Kb(a.N),h.Kb(_.a),h.Kb(b.a),h.Kb(h.i))},HomePage.\u0275cmp=h.Eb({type:HomePage,selectors:[["app-home"]],decls:26,vars:5,consts:[[1,"ion-no-border"],["slot","start"],["slot","end"],[3,"click"],["name","chevron-down-outline","slot","end"],[1,"ion-justify-content-center","ion-padding-top"],["src","./assets/img/beacon_wallets.svg",4,"ngIf"],["src","./assets/img/beacon_ledger.svg",4,"ngIf"],["src","./assets/img/beacon_mobile.svg",4,"ngIf"],[1,"ion-padding-vertical"],[1,"ion-text-center","ion-no-margin"],[4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],["color","primary","fill","outline",3,"click"],["src","./assets/img/beacon_wallets.svg"],["src","./assets/img/beacon_ledger.svg"],["src","./assets/img/beacon_mobile.svg"],[1,"ion-text-center"],[1,"ion-justify-content-center","ion-align-items-center","d-flex","address--container",3,"click"],[3,"address"],["name","open-outline"],[1,"ion-padding-bottom"]],template:function HomePage_Template(e,t){1&e&&(h.Pb(0,"ion-header",0),h.Pb(1,"ion-toolbar"),h.Pb(2,"ion-buttons",1),h.Lb(3,"ion-menu-button"),h.Ob(),h.Pb(4,"ion-title"),h.oc(5,"Spire"),h.Ob(),h.Pb(6,"ion-buttons",2),h.Pb(7,"ion-button",3),h.Xb("click",function HomePage_Template_ion_button_click_7_listener(){return t.openWalletSelection()}),h.oc(8," Wallets "),h.Lb(9,"ion-icon",4),h.Ob(),h.Ob(),h.Ob(),h.Ob(),h.Pb(10,"ion-content"),h.Pb(11,"ion-row",5),h.nc(12,HomePage_img_12_Template,1,0,"img",6),h.nc(13,HomePage_img_13_Template,1,0,"img",7),h.nc(14,HomePage_img_14_Template,1,0,"img",8),h.Ob(),h.Pb(15,"ion-row",9),h.Pb(16,"ion-col"),h.Pb(17,"p",10),h.Pb(18,"small"),h.oc(19,"Paired with"),h.Ob(),h.Ob(),h.Pb(20,"h3",10),h.oc(21),h.Ob(),h.Ob(),h.Ob(),h.nc(22,HomePage_ng_container_22_Template,3,2,"ng-container",11),h.Pb(23,"ion-fab",12),h.Pb(24,"ion-button",13),h.Xb("click",function HomePage_Template_ion_button_click_24_listener(){return t.showPairPage()}),h.oc(25," Pair Wallet "),h.Ob(),h.Ob(),h.Ob()),2&e&&(h.Ab(12),h.fc("ngIf",t.walletType===t.walletTypes.LOCAL_MNEMONIC),h.Ab(1),h.fc("ngIf",t.walletType===t.walletTypes.LEDGER),h.Ab(1),h.fc("ngIf",t.walletType===t.walletTypes.P2P),h.Ab(7),h.pc(t.currentSigningMethod),h.Ab(1),h.fc("ngIf",t.walletType))},directives:[a.p,a.J,a.i,a.x,a.H,a.h,a.q,a.n,a.A,o.l,a.m,a.o,T.a],pipes:[w.a],styles:["ion-row[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:20vh}.address--container[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0 8px}.address--container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin:0 0 0 2px}"]}),HomePage})()}];let N=(()=>{class HomePageRoutingModule{}return HomePageRoutingModule.\u0275fac=function HomePageRoutingModule_Factory(e){return new(e||HomePageRoutingModule)},HomePageRoutingModule.\u0275mod=h.Ib({type:HomePageRoutingModule}),HomePageRoutingModule.\u0275inj=h.Hb({imports:[[r.i.forChild(y)],r.i]}),HomePageRoutingModule})(),k=(()=>{class HomePageModule{}return HomePageModule.\u0275fac=function HomePageModule_Factory(e){return new(e||HomePageModule)},HomePageModule.\u0275mod=h.Ib({type:HomePageModule}),HomePageModule.\u0275inj=h.Hb({imports:[[o.c,i.a,a.K,N,l.a,c.a]]}),HomePageModule})()},EFtB:function(e,t,n){"use strict";n.d(t,"b",function(){return getRpcUrlForNetwork}),n.d(t,"a",function(){return getProtocolForNetwork}),n.d(t,"c",function(){return getTezblockLinkForNetwork}),n.d(t,"d",function(){return to});var o=n("hzei"),i=n("RKiA"),a=n("vrSD"),l=n("14cC");const getRpcUrlForNetwork=async e=>{const t={[o.r.MAINNET]:"https://tezos-node.prod.gke.papers.tech",[o.r.DELPHINET]:"https://tezos-delphinet-node.prod.gke.papers.tech",[o.r.EDONET]:"https://tezos-edonet-node.prod.gke.papers.tech",[o.r.FLORENCENET]:"https://florence-tezos.giganode.io",[o.r.CUSTOM]:""},n={[o.r.MAINNET]:"https://tezos-mainnet-conseil.prod.gke.papers.tech",[o.r.DELPHINET]:"https://tezos-delphinet-conseil.prod.gke.papers.tech",[o.r.EDONET]:"https://tezos-edonet-conseil.prod.gke.papers.tech",[o.r.FLORENCENET]:"",[o.r.CUSTOM]:""};return{rpcUrl:e.rpcUrl?e.rpcUrl:t[e.type],apiUrl:n[e.type]}},getProtocolForNetwork=async e=>{const{rpcUrl:t,apiUrl:n}=await getRpcUrlForNetwork(e),c={[o.r.MAINNET]:"Mainnet",[o.r.DELPHINET]:"Delphinet",[o.r.EDONET]:"Edonet",[o.r.FLORENCENET]:"Florencenet",[o.r.CUSTOM]:"Custom"},r={[o.r.MAINNET]:l.NetworkType.MAINNET,[o.r.DELPHINET]:l.NetworkType.TESTNET,[o.r.EDONET]:l.NetworkType.TESTNET,[o.r.FLORENCENET]:l.NetworkType.TESTNET,[o.r.CUSTOM]:l.NetworkType.CUSTOM},s={[o.r.MAINNET]:"https://tezblock.io",[o.r.DELPHINET]:"https://delphinet.tezblock.io",[o.r.EDONET]:"https://edonet.tezblock.io",[o.r.FLORENCENET]:"https://florencenet.tezblock.io",[o.r.CUSTOM]:"https://florencenet.tezblock.io"},b={[o.r.MAINNET]:a.TezosNetwork.MAINNET,[o.r.EDONET]:a.TezosNetwork.EDONET,[o.r.FLORENCENET]:a.TezosNetwork.EDONET,[o.r.CUSTOM]:a.TezosNetwork.EDONET},p=c[e.type],_=r[e.type],g=s[e.type],P=b[e.type];return new i.TezosProtocol(new i.TezosProtocolOptions(new i.TezosProtocolNetwork(p,_,t,new i.TezblockBlockExplorer(g),new i.TezosProtocolNetworkExtras(P,n,P,"airgap00391"))))},getTezblockLinkForNetwork=async e=>(console.log("network",e),{[o.r.MAINNET]:"https://tezblock.io/account/",[o.r.DELPHINET]:"https://delphinet.tezblock.io/account/",[o.r.EDONET]:"https://edonet.tezblock.io/account/",[o.r.FLORENCENET]:"https://florencenet.tezblock.io/account/",[o.r.CUSTOM]:"http://localhost:8100/account/"}[e?e.type:o.r.MAINNET]);async function to(e,t){try{return{err:null,res:await e}}catch(n){return t&&Object.assign(n,t),{err:n,res:void 0}}}}}]);